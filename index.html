<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å“ˆå°”æ»¨ä¿¡æ¯å·¥ç¨‹å­¦é™¢å¯å®¤å¡ç”Ÿæˆå™¨</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .preselect-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.35);
            backdrop-filter: blur(2px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999
        }

        .preselect-card {
            background: var(--surface);
            width: 520px;
            max-width: 90vw;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(30, 58, 138, 0.18);
            padding: 24px;
            border: 1px solid rgba(30, 58, 138, 0.12);
        }

        .preselect-title {
            font-size: 20px;
            margin: 8px 0 12px;
            text-align: center;
            color: var(--text-primary);
        }

        .preselect-room-types {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 16px
        }

        .preselect-genders {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 16px
        }

        .preselect-room,
        .preselect-gender {
            padding: 10px 14px;
            border: 1px solid rgba(30, 58, 138, 0.15);
            border-radius: 8px;
            background: var(--surface-muted);
            cursor: pointer;
            font-size: 16px;
            transition: all .2s
        }

        .preselect-room:hover:not([disabled]),
        .preselect-gender:hover:not([disabled]) {
            background: #eef2ff
        }

        .preselect-room.active,
        .preselect-gender.active {
            background: linear-gradient(135deg, var(--primary-700), var(--primary));
            color: #fff;
            border-color: transparent;
            box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
        }

        .preselect-actions {
            text-align: center
        }

        #enterSystemBtn {
            padding: 10px 16px;
            border: none;
            border-radius: 8px;
            background: linear-gradient(135deg, var(--primary-700), var(--primary));
            color: #fff;
            font-size: 16px;
            cursor: pointer
        }

        #enterSystemBtn:disabled {
            opacity: .6;
            cursor: not-allowed
        }

        .template-download {
            margin-top: 10px
        }

        .download-template-btn {
            display: inline-block;
            padding: 8px 12px;
            border-radius: 8px;
            background: #28a745;
            color: #fff;
            text-decoration: none;
            font-size: 14px
        }

        .download-template-btn:hover {
            background: #218838
        }
    </style>
</head>

<body>
    <div id="preselectOverlay" class="preselect-overlay">
        <div class="preselect-card">
            <h2 class="preselect-title">è¯·é€‰æ‹©å¯å®¤ç±»å‹</h2>
            <div class="preselect-room-types">
                <button class="preselect-room" data-room="2">åŒäººå¯</button>
                <button class="preselect-room" data-room="3">ä¸‰äººå¯</button>
                <button class="preselect-room" data-room="4">å››äººå¯</button>
                <button class="preselect-room" data-room="5">äº”äººå¯</button>
            </div>
            <h2 class="preselect-title">è¯·é€‰æ‹©æ€§åˆ«</h2>
            <div class="preselect-genders">
                <button class="preselect-gender" data-gender="male" disabled>ç”·å¯</button>
                <button class="preselect-gender" data-gender="female" disabled>å¥³å¯</button>
            </div>
            <div class="preselect-actions">
                <button id="enterSystemBtn" disabled>è¿›å…¥ç”Ÿæˆç•Œé¢</button>
            </div>
        </div>
    </div>
    <div class="container">
        <!-- Logo å“ç‰ŒåŒºåŸŸ -->
        <div class="brand-section">
            <img src="WechatIMG738.jpg" alt="å“ˆå°”æ»¨ä¿¡æ¯å·¥ç¨‹å­¦é™¢æ ‡è¯†" class="brand-logo">
            <h2 class="system-title">å¯å®¤å¡ç”Ÿæˆå™¨</h2>
        </div>

        <!-- å¯¼èˆªæ  -->
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-tabs">
                    <button class="nav-tab" data-room-type="2">åŒäººå¯</button>
                    <button class="nav-tab" data-room-type="3">ä¸‰äººå¯</button>
                    <button class="nav-tab active" data-room-type="4">å››äººå¯</button>
                    <button class="nav-tab" data-room-type="5">äº”äººå¯</button>
                </div>
                <div class="gender-tabs">
                    <button class="gender-tab active" data-gender="male">ç”·å¯</button>
                    <button class="gender-tab" data-gender="female">å¥³å¯</button>
                </div>
            </div>
        </nav>

        <header>
            <p>ä¸Šä¼ Excelæ•°æ®æ–‡ä»¶å’ŒèƒŒæ™¯å›¾ç‰‡ï¼Œè‡ªåŠ¨ç”Ÿæˆå­¦ç”Ÿä¿¡æ¯å¡</p>
        </header>

        <main>
            <div class="upload-section">
                <div class="upload-area" id="excelUpload">
                    <div class="upload-content">
                        <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14,2 14,8 20,8"></polyline>
                            <line x1="16" y1="13" x2="8" y2="13"></line>
                            <line x1="16" y1="17" x2="8" y2="17"></line>
                            <polyline points="10,9 9,9 8,9"></polyline>
                        </svg>
                        <h3>æ‹–æ‹½æˆ–ç‚¹å‡»ä¸Šä¼ Excelæ–‡ä»¶</h3>
                        <p>æ”¯æŒ .xlsx, .xls æ ¼å¼</p>
                        <p class="file-info" id="excelInfo"></p>
                    </div>
                    <input type="file" id="excelFile" accept=".xlsx,.xls" hidden>
                </div>

                <div class="upload-area" id="imageUpload">
                    <div class="upload-content">
                        <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <circle cx="8.5" cy="8.5" r="1.5"></circle>
                            <polyline points="21,15 16,10 5,21"></polyline>
                        </svg>
                        <h3>æ‹–æ‹½æˆ–ç‚¹å‡»ä¸Šä¼ èƒŒæ™¯å›¾ç‰‡</h3>
                        <p>æ”¯æŒ .jpg, .jpeg, .png æ ¼å¼</p>
                        <p class="file-info" id="imageInfo"></p>
                    </div>
                    <input type="file" id="imageFile" accept=".jpg,.jpeg,.png" hidden>
                </div>
            </div>

            <!-- å¯é€‰ï¼šæœ¬åœ°å›¾ç‰‡ç›®å½•ï¼Œç”¨äºå½“Excelæ— å›¾ç‰‡URLæ—¶æŒ‰æ–‡ä»¶ååŒ¹é… -->
            <div class="upload-section" style="margin-top: 16px;">
                <div class="upload-area" id="photoDirArea" style="cursor: default;">
                    <div class="upload-content">
                        <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M3 7h18v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7z"></path>
                            <path d="M3 7l5-4h8l5 4"></path>
                        </svg>
                        <h3>å›¾ç‰‡ç›®å½•è·¯å¾„ï¼ˆå¯é€‰ï¼‰</h3>
                        <p>å½“Excelæ²¡æœ‰â€œå›¾ç‰‡URLâ€æ—¶ï¼ŒæŒ‰ç›®å½•ä¸­æ–‡ä»¶åè‡ªåŠ¨åŒ¹é…ç…§ç‰‡</p>
                        <div style="margin-top: 8px; width: 100%; max-width: 520px;">
                            <input type="text" id="photoDirInput" placeholder="ä¾‹å¦‚ï¼š/Users/username/Desktop/photos"
                                style="width: 100%; padding: 10px; border: 1px dashed #cbd5e1; border-radius: 8px;">
                        </div>
                        <p style="margin-top: 6px; font-size: 13px; color: #64748b;">å‘½åç¤ºä¾‹ï¼š<code>1J218-1åˆ˜é•‡ç‘œ.jpg</code>ï¼ˆæ”¯æŒ
                            .jpg / .jpeg / .pngï¼‰</p>
                    </div>
                </div>
            </div>

            <div class="info-section">
                <h3>ğŸ“‹ Excelæ–‡ä»¶æ ¼å¼è¦æ±‚</h3>
                <p>Excelæ–‡ä»¶éœ€è¦åŒ…å«ä»¥ä¸‹åˆ—ï¼ˆé¡ºåºä¸é™ï¼‰ï¼š</p>
                <ul>
                    <li><strong>å§“å</strong> - å­¦ç”Ÿå§“å</li>
                    <li><strong>å­¦é™¢</strong> - æ‰€å±å­¦é™¢</li>
                    <li><strong>ç­çº§</strong> - ç­çº§ä¿¡æ¯</li>
                    <li><strong>è¾…å¯¼å‘˜</strong> - è¾…å¯¼å‘˜å§“å</li>
                    <li><strong>å¯å®¤å·</strong> - å®¿èˆæˆ¿é—´å·</li>
                    <li><strong>åºŠä½å·</strong> - åºŠä½ç¼–å·</li>
                    <li><strong>å›¾ç‰‡ URL</strong> - å­¦ç”Ÿç…§ç‰‡è·¯å¾„ï¼ˆæ”¯æŒæœ¬åœ°è·¯å¾„å’Œç½‘ç»œé“¾æ¥ï¼‰</li>
                </ul>

                <h4>ğŸ“¸ å›¾ç‰‡è·¯å¾„è¯´æ˜</h4>
                <p><strong>å›¾ç‰‡URLåˆ—</strong>æ”¯æŒä»¥ä¸‹åˆ—åï¼ˆä»»é€‰å…¶ä¸€ï¼‰ï¼š</p>
                <ul>
                    <li><code>å›¾ç‰‡ URL</code>ï¼ˆæ¨èï¼‰</li>
                    <li><code>å›¾ç‰‡URL</code></li>
                    <li><code>ç…§ç‰‡URL</code></li>
                    <li><code>ç…§ç‰‡ URL</code></li>
                </ul>

                <p>å›¾ç‰‡è·¯å¾„æ”¯æŒä»¥ä¸‹æ ¼å¼ï¼š</p>
                <ul>
                    <li><strong>ç½‘ç»œé“¾æ¥ï¼š</strong> https://example.com/photo.jpg</li>
                    <li><strong>ç›¸å¯¹è·¯å¾„ï¼š</strong> photos/student_1.jpgï¼ˆç›¸å¯¹äºExcelæ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼‰</li>
                    <li><strong>ç»å¯¹è·¯å¾„ï¼š</strong> /Users/username/Desktop/photos/student_1.jpg</li>
                </ul>

                <div class="sample-files">
                    <h4>ğŸ“ ç¤ºä¾‹æ–‡ä»¶</h4>
                    <p>é¡¹ç›®ä¸­åŒ…å«ä¸¤ä¸ªç¤ºä¾‹Excelæ–‡ä»¶ï¼š</p>
                    <ul>
                        <li><code>data.xlsx</code> - ä½¿ç”¨ç½‘ç»œå›¾ç‰‡é“¾æ¥</li>
                        <li><code>data_local_photos.xlsx</code> - ä½¿ç”¨æœ¬åœ°å›¾ç‰‡è·¯å¾„</li>
                    </ul>
                </div>
                <div class="template-download">
                    <a href="/download-template" class="download-template-btn" download="æ¨¡æ¿è¡¨.xlsx">ä¸‹è½½æ¨¡æ¿è¡¨ï¼ˆExcelï¼‰</a>
                </div>
            </div>

            <div class="config-section">
                <h3>é…ç½®é€‰é¡¹</h3>
                <div class="config-grid">
                    <div class="config-item">
                        <label for="fontSize">å­—ä½“å¤§å°:</label>
                        <input type="number" id="fontSize" value="20" min="10" max="50">
                    </div>
                    <div class="config-item">
                        <label for="photoWidth">ç…§ç‰‡å®½åº¦:</label>
                        <input type="number" id="photoWidth" value="150" min="50" max="300">
                    </div>
                    <div class="config-item">
                        <label for="photoHeight">ç…§ç‰‡é«˜åº¦:</label>
                        <input type="number" id="photoHeight" value="150" min="50" max="300">
                    </div>
                    <div class="config-item">
                        <label for="photoX">ç…§ç‰‡Xä½ç½®:</label>
                        <input type="number" id="photoX" value="50" min="0" max="500">
                    </div>
                    <div class="config-item">
                        <label for="photoY">ç…§ç‰‡Yä½ç½®:</label>
                        <input type="number" id="photoY" value="300" min="0" max="500">
                    </div>
                    <div class="config-item">
                        <label for="textX">æ–‡æœ¬Xä½ç½®:</label>
                        <input type="number" id="textX" value="50" min="0" max="500">
                    </div>
                    <div class="config-item">
                        <label for="textY">æ–‡æœ¬Yä½ç½®:</label>
                        <input type="number" id="textY" value="50" min="0" max="500">
                    </div>
                    <div class="config-item">
                        <label for="lineSpacing">è¡Œé—´è·:</label>
                        <input type="number" id="lineSpacing" value="25" min="10" max="50">
                    </div>
                </div>
            </div>

            <!-- ä½ç½®è°ƒæ•´åŒºåŸŸå®¹å™¨ -->
            <div class="position-config-container" id="positionConfigContainer">
                <!-- åŒäººå¯ä½ç½®è°ƒæ•´ -->
                <div class="position-config-section room-type-2" id="positionConfigSection2" style="display: none;">
                    <h3>ä½ç½®è°ƒæ•´ - åŒäººå¯</h3>

                    <!-- ä½ç½®1è°ƒæ•´ -->
                    <div class="position-adjustment">
                        <h4>ä½ç½® 1 (å·¦ä¾§)</h4>
                        <div class="position-params-grid">
                            <div>
                                <label>ç…§ç‰‡Xåæ ‡:</label>
                                <input type="number" id="position1PhotoX_2" placeholder="Xåæ ‡" value="240">
                            </div>
                            <div>
                                <label>ç…§ç‰‡Yåæ ‡:</label>
                                <input type="number" id="position1PhotoY_2" placeholder="Yåæ ‡" value="750">
                            </div>
                            <div>
                                <label>ç…§ç‰‡å®½åº¦:</label>
                                <input type="number" id="position1PhotoWidth_2" placeholder="å®½åº¦" min="50" max="300"
                                    value="230">
                            </div>
                            <div>
                                <label>ç…§ç‰‡é«˜åº¦:</label>
                                <input type="number" id="position1PhotoHeight_2" placeholder="é«˜åº¦" min="50" max="300"
                                    value="330">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Xåæ ‡:</label>
                                <input type="number" id="position1TextX_2" placeholder="Xåæ ‡" value="700">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Yåæ ‡:</label>
                                <input type="number" id="position1TextY_2" placeholder="Yåæ ‡" value="770">
                            </div>
                            <div>
                                <label>å­—ä½“å¤§å°:</label>
                                <input type="number" id="position1FontSize_2" placeholder="å­—ä½“å¤§å°" min="10" max="50"
                                    value="25">
                            </div>
                            <div>
                                <label>è¡Œé—´è·:</label>
                                <input type="number" id="position1LineSpacing_2" placeholder="è¡Œé—´è·" min="10" max="50"
                                    value="45">
                            </div>
                        </div>
                    </div>

                    <!-- ä½ç½®2è°ƒæ•´ -->
                    <div class="position-adjustment">
                        <h4>ä½ç½® 2 (å³ä¾§)</h4>
                        <div class="position-params-grid">
                            <div>
                                <label>ç…§ç‰‡Xåæ ‡:</label>
                                <input type="number" id="position2PhotoX_2" placeholder="Xåæ ‡" value="1310">
                            </div>
                            <div>
                                <label>ç…§ç‰‡Yåæ ‡:</label>
                                <input type="number" id="position2PhotoY_2" placeholder="Yåæ ‡" value="-125">
                            </div>
                            <div>
                                <label>ç…§ç‰‡å®½åº¦:</label>
                                <input type="number" id="position2PhotoWidth_2" placeholder="å®½åº¦" min="50" max="300"
                                    value="250">
                            </div>
                            <div>
                                <label>ç…§ç‰‡é«˜åº¦:</label>
                                <input type="number" id="position2PhotoHeight_2" placeholder="é«˜åº¦" min="50" max="300"
                                    value="330">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Xåæ ‡:</label>
                                <input type="number" id="position2TextX_2" placeholder="Xåæ ‡" value="1780">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Yåæ ‡:</label>
                                <input type="number" id="position2TextY_2" placeholder="Yåæ ‡" value="-115">
                            </div>
                            <div>
                                <label>å­—ä½“å¤§å°:</label>
                                <input type="number" id="position2FontSize_2" placeholder="å­—ä½“å¤§å°" min="10" max="50"
                                    value="25">
                            </div>
                            <div>
                                <label>è¡Œé—´è·:</label>
                                <input type="number" id="position2LineSpacing_2" placeholder="è¡Œé—´è·" min="10" max="50"
                                    value="45">
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 20px;">
                        <button id="applyAllBtn_2">åº”ç”¨æ‰€æœ‰è°ƒæ•´</button>
                        <button id="resetAllBtn_2">é‡ç½®æ‰€æœ‰è°ƒæ•´</button>
                    </div>
                </div>

                <!-- ä¸‰äººå¯ä½ç½®è°ƒæ•´ -->
                <div class="position-config-section room-type-3" id="positionConfigSection3" style="display: none;">
                    <h3>ä½ç½®è°ƒæ•´ - ä¸‰äººå¯</h3>

                    <!-- ä½ç½®1è°ƒæ•´ -->
                    <div class="position-adjustment">
                        <h4>ä½ç½® 1 (å·¦ä¾§)</h4>
                        <div class="position-params-grid">
                            <div>
                                <label>ç…§ç‰‡Xåæ ‡:</label>
                                <input type="number" id="position1PhotoX_3" placeholder="Xåæ ‡">
                            </div>
                            <div>
                                <label>ç…§ç‰‡Yåæ ‡:</label>
                                <input type="number" id="position1PhotoY_3" placeholder="Yåæ ‡">
                            </div>
                            <div>
                                <label>ç…§ç‰‡å®½åº¦:</label>
                                <input type="number" id="position1PhotoWidth_3" placeholder="å®½åº¦" min="50" max="300">
                            </div>
                            <div>
                                <label>ç…§ç‰‡é«˜åº¦:</label>
                                <input type="number" id="position1PhotoHeight_3" placeholder="é«˜åº¦" min="50" max="300">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Xåæ ‡:</label>
                                <input type="number" id="position1TextX_3" placeholder="Xåæ ‡">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Yåæ ‡:</label>
                                <input type="number" id="position1TextY_3" placeholder="Yåæ ‡">
                            </div>
                            <div>
                                <label>å­—ä½“å¤§å°:</label>
                                <input type="number" id="position1FontSize_3" placeholder="å­—ä½“å¤§å°" min="10" max="50">
                            </div>
                            <div>
                                <label>è¡Œé—´è·:</label>
                                <input type="number" id="position1LineSpacing_3" placeholder="è¡Œé—´è·" min="10" max="50">
                            </div>
                        </div>
                    </div>

                    <!-- ä½ç½®2è°ƒæ•´ -->
                    <div class="position-adjustment">
                        <h4>ä½ç½® 2 (ä¸­é—´)</h4>
                        <div class="position-params-grid">
                            <div>
                                <label>ç…§ç‰‡Xåæ ‡:</label>
                                <input type="number" id="position2PhotoX_3" placeholder="Xåæ ‡">
                            </div>
                            <div>
                                <label>ç…§ç‰‡Yåæ ‡:</label>
                                <input type="number" id="position2PhotoY_3" placeholder="Yåæ ‡">
                            </div>
                            <div>
                                <label>ç…§ç‰‡å®½åº¦:</label>
                                <input type="number" id="position2PhotoWidth_3" placeholder="å®½åº¦" min="50" max="300">
                            </div>
                            <div>
                                <label>ç…§ç‰‡é«˜åº¦:</label>
                                <input type="number" id="position2PhotoHeight_3" placeholder="é«˜åº¦" min="50" max="300">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Xåæ ‡:</label>
                                <input type="number" id="position2TextX_3" placeholder="Xåæ ‡">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Yåæ ‡:</label>
                                <input type="number" id="position2TextY_3" placeholder="Yåæ ‡">
                            </div>
                            <div>
                                <label>å­—ä½“å¤§å°:</label>
                                <input type="number" id="position2FontSize_3" placeholder="å­—ä½“å¤§å°" min="10" max="50">
                            </div>
                            <div>
                                <label>è¡Œé—´è·:</label>
                                <input type="number" id="position2LineSpacing_3" placeholder="è¡Œé—´è·" min="10" max="50">
                            </div>
                        </div>
                    </div>

                    <!-- ä½ç½®3è°ƒæ•´ -->
                    <div class="position-adjustment">
                        <h4>ä½ç½® 3 (å³ä¾§)</h4>
                        <div class="position-params-grid">
                            <div>
                                <label>ç…§ç‰‡Xåæ ‡:</label>
                                <input type="number" id="position3PhotoX_3" placeholder="Xåæ ‡">
                            </div>
                            <div>
                                <label>ç…§ç‰‡Yåæ ‡:</label>
                                <input type="number" id="position3PhotoY_3" placeholder="Yåæ ‡">
                            </div>
                            <div>
                                <label>ç…§ç‰‡å®½åº¦:</label>
                                <input type="number" id="position3PhotoWidth_3" placeholder="å®½åº¦" min="50" max="300">
                            </div>
                            <div>
                                <label>ç…§ç‰‡é«˜åº¦:</label>
                                <input type="number" id="position3PhotoHeight_3" placeholder="é«˜åº¦" min="50" max="300">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Xåæ ‡:</label>
                                <input type="number" id="position3TextX_3" placeholder="Xåæ ‡">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Yåæ ‡:</label>
                                <input type="number" id="position3TextY_3" placeholder="Yåæ ‡">
                            </div>
                            <div>
                                <label>å­—ä½“å¤§å°:</label>
                                <input type="number" id="position3FontSize_3" placeholder="å­—ä½“å¤§å°" min="10" max="50">
                            </div>
                            <div>
                                <label>è¡Œé—´è·:</label>
                                <input type="number" id="position3LineSpacing_3" placeholder="è¡Œé—´è·" min="10" max="50">
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 20px;">
                        <button id="applyAllBtn_3">åº”ç”¨æ‰€æœ‰è°ƒæ•´</button>
                        <button id="resetAllBtn_3">é‡ç½®æ‰€æœ‰è°ƒæ•´</button>
                    </div>
                </div>

                <!-- å››äººå¯ä½ç½®è°ƒæ•´ -->
                <div class="position-config-section room-type-4" id="positionConfigSection4">
                    <h3>ä½ç½®è°ƒæ•´ - å››äººå¯</h3>

                    <!-- ä½ç½®1è°ƒæ•´ -->
                    <div class="position-adjustment">
                        <h4>ä½ç½® 1 (å·¦ä¸Šè§’)</h4>
                        <div class="position-params-grid">
                            <div>
                                <label>ç…§ç‰‡Xåæ ‡:</label>
                                <input type="number" id="position1PhotoX_4" placeholder="Xåæ ‡" value="185">
                            </div>
                            <div>
                                <label>ç…§ç‰‡Yåæ ‡:</label>
                                <input type="number" id="position1PhotoY_4" placeholder="Yåæ ‡" value="500">
                            </div>
                            <div>
                                <label>ç…§ç‰‡å®½åº¦:</label>
                                <input type="number" id="position1PhotoWidth_4" placeholder="å®½åº¦" min="50" max="500"
                                    value="230">
                            </div>
                            <div>
                                <label>ç…§ç‰‡é«˜åº¦:</label>
                                <input type="number" id="position1PhotoHeight_4" placeholder="é«˜åº¦" min="50" max="500"
                                    value="330">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Xåæ ‡:</label>
                                <input type="number" id="position1TextX_4" placeholder="Xåæ ‡" value="650">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Yåæ ‡:</label>
                                <input type="number" id="position1TextY_4" placeholder="Yåæ ‡" value="522">
                            </div>
                            <div>
                                <label>å­—ä½“å¤§å°:</label>
                                <input type="number" id="position1FontSize_4" placeholder="å­—ä½“å¤§å°" min="10" max="50"
                                    value="25">
                            </div>
                            <div>
                                <label>è¡Œé—´è·:</label>
                                <input type="number" id="position1LineSpacing_4" placeholder="è¡Œé—´è·" min="10" max="50"
                                    value="45">
                            </div>
                        </div>
                    </div>

                    <!-- ä½ç½®2è°ƒæ•´ -->
                    <div class="position-adjustment">
                        <h4>ä½ç½® 2 (å³ä¸Šè§’)</h4>
                        <div class="position-params-grid">
                            <div>
                                <label>ç…§ç‰‡Xåæ ‡:</label>
                                <input type="number" id="position2PhotoX_4" placeholder="Xåæ ‡" value="40">
                            </div>
                            <div>
                                <label>ç…§ç‰‡Yåæ ‡:</label>
                                <input type="number" id="position2PhotoY_4" placeholder="Yåæ ‡" value="500">
                            </div>
                            <div>
                                <label>ç…§ç‰‡å®½åº¦:</label>
                                <input type="number" id="position2PhotoWidth_4" placeholder="å®½åº¦" min="50" max="500"
                                    value="230">
                            </div>
                            <div>
                                <label>ç…§ç‰‡é«˜åº¦:</label>
                                <input type="number" id="position2PhotoHeight_4" placeholder="é«˜åº¦" min="50" max="500"
                                    value="330">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Xåæ ‡:</label>
                                <input type="number" id="position2TextX_4" placeholder="Xåæ ‡" value="480">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Yåæ ‡:</label>
                                <input type="number" id="position2TextY_4" placeholder="Yåæ ‡" value="522">
                            </div>
                            <div>
                                <label>å­—ä½“å¤§å°:</label>
                                <input type="number" id="position2FontSize_4" placeholder="å­—ä½“å¤§å°" min="10" max="50"
                                    value="25">
                            </div>
                            <div>
                                <label>è¡Œé—´è·:</label>
                                <input type="number" id="position2LineSpacing_4" placeholder="è¡Œé—´è·" min="10" max="50"
                                    value="45">
                            </div>
                        </div>
                    </div>

                    <!-- ä½ç½®3è°ƒæ•´ -->
                    <div class="position-adjustment">
                        <h4>ä½ç½® 3 (å·¦ä¸‹è§’)</h4>
                        <div class="position-params-grid">
                            <div>
                                <label>ç…§ç‰‡Xåæ ‡:</label>
                                <input type="number" id="position3PhotoX_4" placeholder="Xåæ ‡" value="185">
                            </div>
                            <div>
                                <label>ç…§ç‰‡Yåæ ‡:</label>
                                <input type="number" id="position3PhotoY_4" placeholder="Yåæ ‡" value="140">
                            </div>
                            <div>
                                <label>ç…§ç‰‡å®½åº¦:</label>
                                <input type="number" id="position3PhotoWidth_4" placeholder="å®½åº¦" min="50" max="500"
                                    value="230">
                            </div>
                            <div>
                                <label>ç…§ç‰‡é«˜åº¦:</label>
                                <input type="number" id="position3PhotoHeight_4" placeholder="é«˜åº¦" min="50" max="500"
                                    value="330">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Xåæ ‡:</label>
                                <input type="number" id="position3TextX_4" placeholder="Xåæ ‡" value="650">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Yåæ ‡:</label>
                                <input type="number" id="position3TextY_4" placeholder="Yåæ ‡" value="140">
                            </div>
                            <div>
                                <label>å­—ä½“å¤§å°:</label>
                                <input type="number" id="position3FontSize_4" placeholder="å­—ä½“å¤§å°" min="10" max="50"
                                    value="25">
                            </div>
                            <div>
                                <label>è¡Œé—´è·:</label>
                                <input type="number" id="position3LineSpacing_4" placeholder="è¡Œé—´è·" min="10" max="50"
                                    value="45">
                            </div>
                        </div>
                    </div>

                    <!-- ä½ç½®4è°ƒæ•´ -->
                    <div class="position-adjustment">
                        <h4>ä½ç½® 4 (å³ä¸‹è§’)</h4>
                        <div class="position-params-grid">
                            <div>
                                <label>ç…§ç‰‡Xåæ ‡:</label>
                                <input type="number" id="position4PhotoX_4" placeholder="Xåæ ‡" value="40">
                            </div>
                            <div>
                                <label>ç…§ç‰‡Yåæ ‡:</label>
                                <input type="number" id="position4PhotoY_4" placeholder="Yåæ ‡" value="140">
                            </div>
                            <div>
                                <label>ç…§ç‰‡å®½åº¦:</label>
                                <input type="number" id="position4PhotoWidth_4" placeholder="å®½åº¦" min="50" max="500"
                                    value="230">
                            </div>
                            <div>
                                <label>ç…§ç‰‡é«˜åº¦:</label>
                                <input type="number" id="position4PhotoHeight_4" placeholder="é«˜åº¦" min="50" max="500"
                                    value="330">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Xåæ ‡:</label>
                                <input type="number" id="position4TextX_4" placeholder="Xåæ ‡" value="480">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Yåæ ‡:</label>
                                <input type="number" id="position4TextY_4" placeholder="Yåæ ‡" value="140">
                            </div>
                            <div>
                                <label>å­—ä½“å¤§å°:</label>
                                <input type="number" id="position4FontSize_4" placeholder="å­—ä½“å¤§å°" min="10" max="50"
                                    value="25">
                            </div>
                            <div>
                                <label>è¡Œé—´è·:</label>
                                <input type="number" id="position4LineSpacing_4" placeholder="è¡Œé—´è·" min="10" max="50"
                                    value="45">
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 20px;">
                        <button id="applyAllBtn_4">åº”ç”¨æ‰€æœ‰è°ƒæ•´</button>
                        <button id="resetAllBtn_4">é‡ç½®æ‰€æœ‰è°ƒæ•´</button>
                    </div>
                </div>

                <!-- äº”äººå¯ä½ç½®è°ƒæ•´ -->
                <div class="position-config-section room-type-5" id="positionConfigSection5" style="display: none;">
                    <h3>ä½ç½®è°ƒæ•´ - äº”äººå¯</h3>

                    <!-- ä½ç½®1è°ƒæ•´ -->
                    <div class="position-adjustment">
                        <h4>ä½ç½® 1 (å·¦ä¸Šè§’)</h4>
                        <div class="position-params-grid">
                            <div>
                                <label>ç…§ç‰‡Xåæ ‡:</label>
                                <input type="number" id="position1PhotoX_5" placeholder="Xåæ ‡" value="-125">
                            </div>
                            <div>
                                <label>ç…§ç‰‡Yåæ ‡:</label>
                                <input type="number" id="position1PhotoY_5" placeholder="Yåæ ‡" value="480">
                            </div>
                            <div>
                                <label>ç…§ç‰‡å®½åº¦:</label>
                                <input type="number" id="position1PhotoWidth_5" placeholder="å®½åº¦" min="50" max="500"
                                    value="230">
                            </div>
                            <div>
                                <label>ç…§ç‰‡é«˜åº¦:</label>
                                <input type="number" id="position1PhotoHeight_5" placeholder="é«˜åº¦" min="50" max="500"
                                    value="330">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Xåæ ‡:</label>
                                <input type="number" id="position1TextX_5" placeholder="Xåæ ‡" value="340">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Yåæ ‡:</label>
                                <input type="number" id="position1TextY_5" placeholder="Yåæ ‡" value="490">
                            </div>
                            <div>
                                <label>å­—ä½“å¤§å°:</label>
                                <input type="number" id="position1FontSize_5" placeholder="å­—ä½“å¤§å°" min="10" max="50"
                                    value="25">
                            </div>
                            <div>
                                <label>è¡Œé—´è·:</label>
                                <input type="number" id="position1LineSpacing_5" placeholder="è¡Œé—´è·" min="10" max="50"
                                    value="45">
                            </div>
                        </div>
                    </div>

                    <!-- ä½ç½®2è°ƒæ•´ -->
                    <div class="position-adjustment">
                        <h4>ä½ç½® 2 (å³ä¸Šè§’)</h4>
                        <div class="position-params-grid">
                            <div>
                                <label>ç…§ç‰‡Xåæ ‡:</label>
                                <input type="number" id="position2PhotoX_5" placeholder="Xåæ ‡" value="-550">
                            </div>
                            <div>
                                <label>ç…§ç‰‡Yåæ ‡:</label>
                                <input type="number" id="position2PhotoY_5" placeholder="Yåæ ‡" value="480">
                            </div>
                            <div>
                                <label>ç…§ç‰‡å®½åº¦:</label>
                                <input type="number" id="position2PhotoWidth_5" placeholder="å®½åº¦" min="50" max="300"
                                    value="230">
                            </div>
                            <div>
                                <label>ç…§ç‰‡é«˜åº¦:</label>
                                <input type="number" id="position2PhotoHeight_5" placeholder="é«˜åº¦" min="50" max="300"
                                    value="330">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Xåæ ‡:</label>
                                <input type="number" id="position2TextX_5" placeholder="Xåæ ‡" value="-90">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Yåæ ‡:</label>
                                <input type="number" id="position2TextY_5" placeholder="Yåæ ‡" value="490">
                            </div>
                            <div>
                                <label>å­—ä½“å¤§å°:</label>
                                <input type="number" id="position2FontSize_5" placeholder="å­—ä½“å¤§å°" min="10" max="50"
                                    value="25">
                            </div>
                            <div>
                                <label>è¡Œé—´è·:</label>
                                <input type="number" id="position2LineSpacing_5" placeholder="è¡Œé—´è·" min="10" max="50"
                                    value="45">
                            </div>
                        </div>
                    </div>

                    <!-- ä½ç½®3è°ƒæ•´ -->
                    <div class="position-adjustment">
                        <h4>ä½ç½® 3 (å·¦ä¸‹è§’)</h4>
                        <div class="position-params-grid">
                            <div>
                                <label>ç…§ç‰‡Xåæ ‡:</label>
                                <input type="number" id="position3PhotoX_5" placeholder="Xåæ ‡" value="-310">
                            </div>
                            <div>
                                <label>ç…§ç‰‡Yåæ ‡:</label>
                                <input type="number" id="position3PhotoY_5" placeholder="Yåæ ‡" value="140">
                            </div>
                            <div>
                                <label>ç…§ç‰‡å®½åº¦:</label>
                                <input type="number" id="position3PhotoWidth_5" placeholder="å®½åº¦" min="50" max="300"
                                    value="230">
                            </div>
                            <div>
                                <label>ç…§ç‰‡é«˜åº¦:</label>
                                <input type="number" id="position3PhotoHeight_5" placeholder="é«˜åº¦" min="50" max="300"
                                    value="330">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Xåæ ‡:</label>
                                <input type="number" id="position3TextX_5" placeholder="Xåæ ‡" value="170">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Yåæ ‡:</label>
                                <input type="number" id="position3TextY_5" placeholder="Yåæ ‡" value="140">
                            </div>
                            <div>
                                <label>å­—ä½“å¤§å°:</label>
                                <input type="number" id="position3FontSize_5" placeholder="å­—ä½“å¤§å°" min="10" max="50"
                                    value="25">
                            </div>
                            <div>
                                <label>è¡Œé—´è·:</label>
                                <input type="number" id="position3LineSpacing_5" placeholder="è¡Œé—´è·" min="10" max="50"
                                    value="45">
                            </div>
                        </div>
                    </div>

                    <!-- ä½ç½®4è°ƒæ•´ -->
                    <div class="position-adjustment">
                        <h4>ä½ç½® 4 (å³ä¸‹è§’)</h4>
                        <div class="position-params-grid">
                            <div>
                                <label>ç…§ç‰‡Xåæ ‡:</label>
                                <input type="number" id="position4PhotoX_5" placeholder="Xåæ ‡" value="-330">
                            </div>
                            <div>
                                <label>ç…§ç‰‡Yåæ ‡:</label>
                                <input type="number" id="position4PhotoY_5" placeholder="Yåæ ‡" value="140">
                            </div>
                            <div>
                                <label>ç…§ç‰‡å®½åº¦:</label>
                                <input type="number" id="position4PhotoWidth_5" placeholder="å®½åº¦" min="50" max="300"
                                    value="230">
                            </div>
                            <div>
                                <label>ç…§ç‰‡é«˜åº¦:</label>
                                <input type="number" id="position4PhotoHeight_5" placeholder="é«˜åº¦" min="50" max="300"
                                    value="330">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Xåæ ‡:</label>
                                <input type="number" id="position4TextX_5" placeholder="Xåæ ‡" value="140">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Yåæ ‡:</label>
                                <input type="number" id="position4TextY_5" placeholder="Yåæ ‡" value="140">
                            </div>
                            <div>
                                <label>å­—ä½“å¤§å°:</label>
                                <input type="number" id="position4FontSize_5" placeholder="å­—ä½“å¤§å°" min="10" max="50"
                                    value="25">
                            </div>
                            <div>
                                <label>è¡Œé—´è·:</label>
                                <input type="number" id="position4LineSpacing_5" placeholder="è¡Œé—´è·" min="10" max="50"
                                    value="45">
                            </div>
                        </div>
                    </div>

                    <!-- ä½ç½®5è°ƒæ•´ -->
                    <div class="position-adjustment">
                        <h4>ä½ç½® 5 (ä¸­é—´)</h4>
                        <div class="position-params-grid">
                            <div>
                                <label>ç…§ç‰‡Xåæ ‡:</label>
                                <input type="number" id="position5PhotoX_5" placeholder="Xåæ ‡" value="-350">
                            </div>
                            <div>
                                <label>ç…§ç‰‡Yåæ ‡:</label>
                                <input type="number" id="position5PhotoY_5" placeholder="Yåæ ‡" value="140">
                            </div>
                            <div>
                                <label>ç…§ç‰‡å®½åº¦:</label>
                                <input type="number" id="position5PhotoWidth_5" placeholder="å®½åº¦" min="50" max="300"
                                    value="230">
                            </div>
                            <div>
                                <label>ç…§ç‰‡é«˜åº¦:</label>
                                <input type="number" id="position5PhotoHeight_5" placeholder="é«˜åº¦" min="50" max="300"
                                    value="330">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Xåæ ‡:</label>
                                <input type="number" id="position5TextX_5" placeholder="Xåæ ‡" value="110">
                            </div>
                            <div>
                                <label>æ–‡æœ¬Yåæ ‡:</label>
                                <input type="number" id="position5TextY_5" placeholder="Yåæ ‡" value="140">
                            </div>
                            <div>
                                <label>å­—ä½“å¤§å°:</label>
                                <input type="number" id="position5FontSize_5" placeholder="å­—ä½“å¤§å°" min="10" max="50"
                                    value="25">
                            </div>
                            <div>
                                <label>è¡Œé—´è·:</label>
                                <input type="number" id="position5LineSpacing_5" placeholder="è¡Œé—´è·" min="10" max="50"
                                    value="45">
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 20px;">
                        <button id="applyAllBtn_5">åº”ç”¨æ‰€æœ‰è°ƒæ•´</button>
                        <button id="resetAllBtn_5">é‡ç½®æ‰€æœ‰è°ƒæ•´</button>
                    </div>
                </div>
            </div>

            <div class="action-section">
                <button id="generateBtn" class="generate-btn" disabled>
                    <span class="btn-text">ç”Ÿæˆä¿¡æ¯å¡</span>
                    <div class="loading-spinner" style="display: none;"></div>
                </button>
            </div>

            <div class="result-section" id="resultSection" style="display: none;">
                <h3>ç”Ÿæˆç»“æœ</h3>
                <div class="result-info" id="resultInfo"></div>
                <!-- æœªåŒ¹é…äººå‘˜åˆ—è¡¨ -->
                <div class="unmatched-section" id="unmatchedSection" style="display: none;">
                    <h4 class="unmatched-title">æœªåŒ¹é…åˆ°ç…§ç‰‡çš„äººå‘˜ï¼ˆå…± <span id="unmatchedCount">0</span> äººï¼‰</h4>
                    <ul id="unmatchedList" class="unmatched-list"></ul>
                </div>
                <div class="pagination-controls" id="paginationControls" style="display: none;">
                    <button id="prevBtn" class="nav-btn" disabled>â† ä¸Šä¸€é¡µ</button>
                    <div class="page-selector">
                        <span>ç¬¬</span>
                        <select id="pageSelect" class="page-select"></select>
                        <span>é¡µï¼Œå…± <span id="totalPages">1</span> é¡µ</span>
                    </div>
                    <button id="nextBtn" class="nav-btn" disabled>ä¸‹ä¸€é¡µ â†’</button>
                </div>
                <div class="result-display" id="resultDisplay">
                    <div class="current-card" id="currentCard"></div>
                </div>
                <div class="download-buttons">
                    <button id="downloadBtn" class="download-btn">ä¸‹è½½æ‰€æœ‰å›¾ç‰‡</button>
                    <button id="downloadZipBtn" class="download-btn"
                        style="background: linear-gradient(135deg, #28a745, #20c997);">æ‰“åŒ…ä¸‹è½½ZIP</button>
                </div>
            </div>
        </main>

        <footer>
            <p>&copy; 2025 å“ˆå°”æ»¨ä¿¡æ¯å·¥ç¨‹å­¦é™¢å¯å®¤å¡ç”Ÿæˆå™¨</p>
        </footer>
    </div>

    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            var overlay = document.getElementById('preselectOverlay');
            if (!overlay) { return }
            var selectedRoom = null; var selectedGender = null;
            var roomBtns = overlay.querySelectorAll('.preselect-room');
            var genderBtns = overlay.querySelectorAll('.preselect-gender');
            var enterBtn = document.getElementById('enterSystemBtn');
            function updateEnter() { enterBtn.disabled = !(selectedRoom && selectedGender) }
            roomBtns.forEach(function (btn) {
                btn.addEventListener('click', function () {
                    selectedRoom = btn.dataset.room;
                    roomBtns.forEach(function (b) { b.classList.toggle('active', b === btn) });
                    genderBtns.forEach(function (g) { g.disabled = false });
                    updateEnter();
                })
            });
            genderBtns.forEach(function (btn) {
                btn.addEventListener('click', function () {
                    selectedGender = btn.dataset.gender;
                    genderBtns.forEach(function (b) { b.classList.toggle('active', b === btn) });
                    updateEnter();
                })
            });
            enterBtn.addEventListener('click', function () {
                if (!(selectedRoom && selectedGender)) { return }
                try {
                    window.currentRoomType = parseInt(selectedRoom, 10);
                    window.currentGender = selectedGender;
                    if (typeof switchRoomType === 'function') { switchRoomType(window.currentRoomType) }
                    if (typeof switchGender === 'function') { switchGender(window.currentGender) }
                } catch (e) { console.error(e) }
                overlay.style.display = 'none';
                window.scrollTo(0, 0);
            });
        });
    </script>
</body>

</html>