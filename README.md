# 学生信息卡生成器

一个基于Flask和PIL的Web应用程序，用于批量生成学生信息卡。支持多种寝室类型配置，男女寝室独立管理，以及灵活的位置调整功能。

## ✨ 功能特点

### 🏠 多寝室类型支持
- **双人寝、三人寝、四人寝、五人寝**：支持2-5人寝室的信息卡生成
- **男女寝室独立**：每种寝室类型都可以独立选择男寝或女寝
- **数据完全隔离**：男女寝室的Excel文件、背景图片、生成结果等数据完全分离

### 📊 Excel数据处理
- **智能字段识别**：自动识别Excel中的学生信息字段
- **必需字段**：姓名、学院、班级、辅导员、寝室号、床位号、图片URL
- **容错处理**：自动处理空值和异常数据

### 🎨 图片生成与定制
- **批量生成**：一次性生成所有学生的信息卡
- **位置调整**：支持照片位置、文本位置、字体大小、行间距等精细调整
- **实时预览**：支持分页浏览生成的信息卡
- **多格式支持**：支持JPG、PNG等常见图片格式

### 📦 下载功能
- **单张下载**：支持下载单张信息卡
- **批量下载**：一键打包下载所有信息卡为ZIP文件
- **智能命名**：ZIP文件自动命名为"学院名称-性别-X人寝"格式

### 🎯 用户体验
- **拖拽上传**：支持拖拽上传Excel和图片文件
- **无刷新切换**：寝室类型和性别切换无需页面刷新
- **响应式设计**：适配不同屏幕尺寸
- **实时反馈**：操作状态实时显示

## 🚀 快速开始

### 环境要求
- Python 3.7+
- 现代浏览器（Chrome、Firefox、Safari等）

### 安装步骤

1. **克隆项目**
```bash
git clone <repository-url>
cd Excel
```

2. **安装依赖**
```bash
pip install -r requirements.txt
```

3. **启动服务**
```bash
python app.py
```

4. **访问应用**
打开浏览器访问：http://localhost:5002

## 📋 使用说明

### 1. 准备Excel文件
Excel文件需要包含以下列（列名必须完全匹配）：
- **姓名** - 学生姓名
- **学院** - 所属学院
- **班级** - 班级信息
- **辅导员** - 辅导员姓名
- **寝室号** - 宿舍房间号
- **床位号** - 床位编号
- **图片 URL** - 学生照片路径（支持本地路径和网络链接）

### 2. 选择寝室配置
- 在顶部导航栏选择寝室类型（双人寝、三人寝、四人寝、五人寝）
- 在右侧选择男寝或女寝
- 不同配置的数据完全独立，可以自由切换

### 3. 上传文件
- **Excel文件**：拖拽或点击上传包含学生信息的Excel文件
- **背景图片**：上传用作信息卡背景的图片文件

### 4. 生成信息卡
- 点击"生成信息卡"按钮开始处理
- 系统会自动根据寝室类型排版学生信息
- 生成完成后可以预览所有信息卡

### 5. 位置调整（可选）
- 在位置调整区域微调照片和文本的位置
- 支持调整照片尺寸、文本位置、字体大小、行间距
- 点击"应用所有调整"重新生成信息卡

### 6. 下载结果
- **单张下载**：点击信息卡下方的下载按钮
- **批量下载**：点击"下载ZIP文件"获取所有信息卡

## 🏗️ 项目结构

```
Excel/
├── app.py                 # Flask主应用
├── index.html            # 前端页面
├── script.js             # JavaScript逻辑
├── style.css             # 样式文件
├── requirements.txt      # Python依赖
├── uploads/              # 上传文件存储
├── static/output/        # 生成的图片存储
├── background.jpg        # 默认背景图片
└── README.md            # 项目文档
```

## 🔧 技术栈

### 后端
- **Flask** - Web框架
- **Pandas** - Excel数据处理
- **PIL (Pillow)** - 图像处理
- **Requests** - HTTP请求处理

### 前端
- **HTML5** - 页面结构
- **CSS3** - 样式设计
- **JavaScript (ES6+)** - 交互逻辑
- **拖拽API** - 文件上传

## ⚙️ 配置说明

### 寝室布局配置
系统内置了2-5人寝室的默认布局配置，包括：
- 照片位置和尺寸
- 文本位置和字体
- 行间距和对齐方式

### 文件限制
- Excel文件：最大16MB，支持.xlsx和.xls格式
- 图片文件：最大16MB，支持.jpg、.jpeg、.png格式

### 字体配置
系统会自动尝试加载以下字体（按优先级）：
1. PingFang.ttc（macOS中文字体）
2. STHeiti Light.ttc（备选中文字体）
3. Arial Unicode MS.ttf（Unicode字体）
4. Arial.ttf（英文字体）
5. 系统默认字体

## 🐛 常见问题

### Q: Excel文件上传后提示格式错误？
A: 请确保Excel文件包含所有必需的列名，且列名完全匹配（区分大小写）。

### Q: 生成的信息卡中照片显示异常？
A: 请检查Excel中的"图片 URL"列是否包含有效的图片路径或网络链接。

### Q: 如何调整信息卡的布局？
A: 使用页面下方的位置调整功能，可以精细调整照片和文本的位置、大小等参数。

### Q: 不同寝室类型的数据会互相影响吗？
A: 不会。每种寝室类型的男女寝室数据完全独立，切换时不会丢失已上传的文件或生成的结果。

## 📝 更新日志

### v2.0.0
- ✨ 新增男女寝室独立管理功能
- 🎨 优化用户界面，采用左右分布式导航
- 📦 改进ZIP文件命名，包含性别信息
- 🔧 重构数据结构，支持多维度状态管理

### v1.0.0
- 🎉 初始版本发布
- 📊 支持Excel数据批量处理
- 🎨 实现多寝室类型信息卡生成
- 📦 提供单张和批量下载功能

## 🤝 贡献指南

欢迎提交Issue和Pull Request来改进这个项目！

## 📄 许可证

本项目采用MIT许可证，详见LICENSE文件。

## 📞 联系方式

如有问题或建议，请通过以下方式联系：
- 提交GitHub Issue
- 发送邮件至：[your-email@example.com]

---

**享受使用学生信息卡生成器！** 🎓✨